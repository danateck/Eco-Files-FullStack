<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eco Wellness Login</title>
  <link rel="stylesheet" href="./styleLogin.css">
</head>

<body>
    <div class="nature-background">
        <div class="floating-leaf leaf-1"></div>
        <div class="floating-leaf leaf-2"></div>
        <div class="floating-leaf leaf-3"></div>
        <div class="floating-leaf leaf-4"></div>
    </div>

    <div class="login-container">
        <div class="wellness-card">
            <div class="organic-border"></div>
            
            <div class="mindful-header">
                <div class="zen-logo">
                    <svg width="56" height="56" viewBox="0 0 56 56" fill="none">
                        <circle cx="28" cy="28" r="26" stroke="currentColor" stroke-width="2" fill="none" opacity="0.6"/>
                        <circle cx="28" cy="28" r="18" stroke="currentColor" stroke-width="1.5" fill="none" opacity="0.8"/>
                        <circle cx="28" cy="28" r="10" fill="currentColor" opacity="0.9"/>
                        <path d="M28 18v20M18 28h20" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <div class="zen-glow"></div>
                </div>
                <h1>Eco File - סידור מסמכים </h1>
                <p>היכנס לארכיון החכם שלך</p>
            </div>
            
            <form class="harmony-form" id="loginForm" novalidate>
                <div class="organic-field">
                    <div class="field-nature"></div>
                    <input type="email" id="email" name="email" required autocomplete="email">
                    <label for="email">Email Address</label>
                    <div class="growth-indicator">
                        <div class="leaf-sprout"></div>
                    </div>
                    <span class="gentle-error" id="emailError"></span>
                </div>

                <div class="organic-field">
                    <div class="field-nature"></div>
                    <input type="password" id="password" name="password" required autocomplete="current-password">
                    <label for="password">Password</label>
                    <button type="button" class="nature-toggle" id="passwordToggle" aria-label="Toggle password visibility">
                        <svg class="eye-visible" width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 4c-4 0-7 3-8 6 1 3 4 6 8 6s7-3 8-6c-1-3-4-6-8-6zm0 10a4 4 0 110-8 4 4 0 010 8zm0-6a2 2 0 100 4 2 2 0 000-4z" fill="currentColor"/>
                        </svg>
                        <svg class="eye-hidden" width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M3 3l14 14M8.5 8.5a2 2 0 002.83 2.83m-.83-4.83a4 4 0 014 4M10 6C6 6 3 9 2 12c.5 1.5 2 3.5 4 4.5M10 14c4 0 7-3 8-6-.5-1.5-2-3.5-4-4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <span class="gentle-error" id="passwordError"></span>
                </div>

                <div class="mindful-options">
                    <label class="zen-checkbox">
                        <input type="checkbox" id="remember" name="remember">
                        <span class="checkbox-leaf">
                            <div class="leaf-shape"></div>
                            <svg width="10" height="8" viewBox="0 0 10 8" fill="none">
                                <path d="M1 4l2.5 2.5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                        <span class="checkbox-text">Keep me centered</span>
                    </label>
                    <a href="#" class="healing-link">Forgot Password?</a>
                </div>



                <div style="text-align:center; margin-top: 0.75rem;">

</div>



                <button type="submit" class="harmony-button">
                    <div class="button-earth"></div>
                    <span class="button-text">היכנס לארכיון</span>
                    <div class="button-growth">
                        <div class="growing-circle circle-1"></div>
                        <div class="growing-circle circle-2"></div>
                        <div class="growing-circle circle-3"></div>
                    </div>
                    <div class="button-aura"></div>
                </button>
            </form>


            <div id="resetModal" class="reset-modal hidden">
  <div class="reset-card">
    <h3 class="reset-title">איפוס סיסמה</h3>
    <p class="reset-desc">הקלד/י סיסמה חדשה עבור החשבון שלך</p>

    <input id="newPasswordInput" type="password" class="reset-input" placeholder="סיסמה חדשה" />

    <div class="reset-buttons">
      <button id="resetCancelBtn" class="reset-btn cancel">בטל</button>
      <button id="resetSaveBtn" class="reset-btn save">שמור סיסמה חדשה</button>
    </div>
  </div>
</div>

            <div class="balance-divider">
                <div class="divider-branch"></div>
                <div class="divider-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M12 2L8 8h8l-4-6zM12 22l4-6H8l4 6zM2 12l6-4v8l-6-4zM22 12l-6 4V8l6 4z" fill="currentColor" opacity="0.6"/>
                    </svg>
                </div>
                <div class="divider-branch"></div>
            </div>

            <div class="natural-social">
                <button type="button" class="earth-social">
                    <div class="social-earth"></div>
                    <svg width="18" height="18" viewBox="0 0 18 18">
                        <path fill="#4285F4" d="M16.2 9.2c0-.5-.04-1-.12-1.5H9.2v2.8h3.9a3.4 3.4 0 01-1.5 2.2v1.8h2.4c1.4-1.3 2.2-3.2 2.2-5.3z"/>
                        <path fill="#34A853" d="M9.2 16.5c2 0 3.7-.7 4.9-1.8l-2.4-1.8c-.7.5-1.5.7-2.5.7-1.9 0-3.6-1.3-4.2-3H2.6v1.8c1.2 2.4 3.7 4.1 6.6 4.1z"/>
                        <path fill="#FBBC05" d="M5 10.8a5.2 5.2 0 010-2.6V6.4H2.6a8.6 8.6 0 000 7.2L5 10.8z"/>
                        <path fill="#EA4335" d="M9.2 4.4c1.1 0 2.1.4 2.9 1.1l2.1-2.1C12.8 2.2 11.1 1.5 9.2 1.5c-2.9 0-5.4 1.7-6.6 4.1L5 7.4c.6-1.8 2.3-3 4.2-3z"/>
                    </svg>
                    <span>Google</span>
                    <div class="social-glow"></div>
                </button>
                
                
            </div>

            

            <div class="harmony-success" id="successMessage">
                <div class="success-mandala">
                    <div class="mandala-ring ring-1"></div>
                    <div class="mandala-ring ring-2"></div>
                    <div class="mandala-ring ring-3"></div>
                    <div class="mandala-center">
                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                            <path d="M8 14l6 6 12-12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
                <h3>Welcome Home</h3>
                <p>Your sanctuary awaits...</p>
            </div>
        </div>
    </div>



<!-- ===== OTP / 2FA Screen (קוד חד פעמי במייל) ===== -->
<div id="otpContainer" style="display:none;">
  <main class="relative min-h-screen flex flex-col justify-center bg-slate-50 overflow-hidden">
    <div class="w-full max-w-6xl mx-auto px-4 md:px-6 py-24">
      <div class="flex justify-center">

        <div class="max-w-md mx-auto text-center bg-white px-4 sm:px-8 py-10 rounded-xl shadow">
          <header class="mb-8">
            <h1 class="text-2xl font-bold mb-1">אימות כניסה</h1>
            <p class="text-[15px] text-slate-500">
              הזיני את הקוד בן 4 ספרות שנשלח אלייך למייל.
            </p>
          </header>

          <!-- שימי לב: id="otp-form" והאינפוטים עם class="otp-input" -->
          <form id="otp-form">
            <div class="flex items-center justify-center gap-3">
              <input
                type="text"
                maxlength="1"
                class="otp-input w-14 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent appearance-none rounded p-4 outline-none" />
              <input
                type="text"
                maxlength="1"
                class="otp-input w-14 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent appearance-none rounded p-4 outline-none" />
              <input
                type="text"
                maxlength="1"
                class="otp-input w-14 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent appearance-none rounded p-4 outline-none" />
              <input
                type="text"
                maxlength="1"
                class="otp-input w-14 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent appearance-none rounded p-4 outline-none" />
            </div>

            <div class="max-w-[260px] mx-auto mt-4">
              <button type="submit"
                class="w-full inline-flex justify-center whitespace-nowrap rounded-lg bg-indigo-500 px-3.5 py-2.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-600 transition-colors duration-150">
                אימות והמשך
              </button>
            </div>
          </form>

          <div class="text-sm text-slate-500 mt-4">
            לא קיבלת קוד?
            <a id="otpResend" class="font-medium text-indigo-500 hover:text-indigo-600" href="#0">
              שלחי שוב
            </a>
          </div>
        </div>

      </div>
    </div>
  </main>
</div>






    <!-- 2FA Modal -->
<div id="twofaOverlay" class="twofa-overlay" style="display:none;">
  <div class="twofa-modal">
    <h2 class="twofa-title">אימות דו־שלבי</h2>
    <p class="twofa-text">
      שלחנו אלייך קוד בן 6 ספרות לכתובת המייל שלך.
      הזיני את הקוד כדי להיכנס.
    </p>

    <form id="twofaForm" class="twofa-form">
      <div class="twofa-inputs">
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
      </div>

      <div id="twofaError" class="twofa-error"></div>

      <div class="twofa-buttons">
        <button type="submit" class="harmony-button">אשר קוד</button>
        <button type="button" id="twofaCancel" class="harmony-button secondary">
          ביטול
        </button>
      </div>
    </form>

    <div class="twofa-resend">
      לא קיבלת קוד?
      <button type="button" id="twofaResend" class="twofa-resend-link">
        שליחה מחדש
      </button>
    </div>
  </div>
</div>





<script type="module" src="../../firebase-config.js"></script>
<script type="module" src="../../JS/authCheck.js"></script>










<!-- Firebase Phone 2FA - Simple UI -->

<!-- Hidden reCAPTCHA container -->
<div id="recaptcha-container"></div>

<!-- Phone Setup Modal (פעם ראשונה) -->
<div id="phoneSetupModal" class="twofa-overlay" style="display:none;">
  <div class="twofa-modal">
    <h2 class="twofa-title">הפעלת אימות דו-שלבי</h2>
    <p class="twofa-text">
      נא להזין את מספר הטלפון שלך. נשלח אליך SMS עם קוד אימות.
    </p>

    <form id="phoneSetupForm" class="twofa-form">
      <div class="phone-input-container">
        <label for="phoneInput">מספר טלפון</label>
        <div class="phone-input-wrapper">
          <input 
            type="tel" 
            id="phoneInput" 
            placeholder="050-123-4567"
            dir="ltr"
          />
        </div>
        <span class="phone-hint">פורמט: 050-123-4567</span>
      </div>

      <div id="phoneError" class="twofa-error"></div>

      <div class="twofa-buttons">
        <button type="submit" class="harmony-button">שלח קוד אימות</button>
        <button type="button" id="phoneSkip" class="harmony-button secondary">
          דלג
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Phone Verification Modal (אימות הקוד) -->
<div id="phoneVerifyModal" class="twofa-overlay" style="display:none;">
  <div class="twofa-modal">
    <h2 class="twofa-title">אימות SMS</h2>
    <p class="twofa-text">
      שלחנו קוד בן 6 ספרות למספר:<br>
      <strong id="verifyPhoneDisplay">+972-50-XXX-XXXX</strong>
    </p>

    <form id="phoneVerifyForm" class="twofa-form">
      <div class="twofa-inputs">
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
        <input type="text" maxlength="1" inputmode="numeric" class="twofa-digit" />
      </div>

      <div id="verifyError" class="twofa-error"></div>

      <div class="twofa-buttons">
        <button type="submit" class="harmony-button">אמת קוד</button>
        <button type="button" id="verifyCancel" class="harmony-button secondary">
          ביטול
        </button>
      </div>
    </form>

    <div class="twofa-resend">
      לא קיבלת SMS?
      <button type="button" id="phoneResend" class="twofa-resend-link">
        שלח שוב
      </button>
    </div>
  </div>
</div>

<style>
/* Phone Input Specific Styles */
.phone-input-container {
  margin-bottom: 20px;
  text-align: right;
}

.phone-input-container label {
  display: block;
  font-weight: 600;
  margin-bottom: 8px;
  color: #333;
}

.phone-input-wrapper {
  position: relative;
}

.phone-input-wrapper input {
  width: 100%;
  padding: 14px 16px;
  font-size: 18px;
  font-weight: 600;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  background: #f8f9fa;
  transition: all 0.3s ease;
  direction: ltr;
  text-align: center;
}

.phone-input-wrapper input:focus {
  outline: none;
  border-color: #4CAF50;
  background: white;
  box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.1);
}

.phone-hint {
  display: block;
  font-size: 13px;
  color: #666;
  margin-top: 6px;
}

#verifyPhoneDisplay {
  color: #4CAF50;
  font-weight: 700;
  direction: ltr;
}

/* Hide reCAPTCHA badge (optional) */
.grecaptcha-badge {
  visibility: hidden;
}
</style>

<script>
/**
 * דוגמא לשימוש ב-Firebase Phone 2FA
 * (להוסיף את הקוד הזה לתוך scriptLogin.js)
 */

// דוגמא: שליחת קוד אימות
async function sendPhoneVerification(phoneNumber) {
    try {
        await window.firebasePhone2FA.sendVerificationCode(phoneNumber);
        console.log('✅ SMS sent to:', phoneNumber);
        return true;
    } catch (error) {
        console.error('❌ Failed to send:', error.message);
        alert(error.message);
        return false;
    }
}

// דוגמא: אימות קוד
async function verifyPhoneCode(code) {
    try {
        await window.firebasePhone2FA.verifyCode(code);
        console.log('✅ Code verified!');
        return true;
    } catch (error) {
        console.error('❌ Verification failed:', error.message);
        alert(error.message);
        return false;
    }
}

// דוגמא: זרימה מלאה
async function fullPhone2FAFlow() {
    // 1. בקש מספר טלפון
    const phone = prompt('Enter phone: +972...');
    
    // 2. שלח SMS
    const sent = await sendPhoneVerification(phone);
    if (!sent) return false;
    
    // 3. בקש קוד
    const code = prompt('Enter 6-digit code:');
    
    // 4. אמת
    const verified = await verifyPhoneCode(code);
    return verified;
}
</script>



<!-- Firebase Phone 2FA Script -->
<script type="module" src="./firebase-phone-2fa.js"></script>

<script type="module" src="./scriptLogin.js"></script>

<!-- <script>
  document.addEventListener('DOMContentLoaded', () => {
    // ONLY login page calls redirectIfLoggedIn()
    if (typeof redirectIfLoggedIn === 'function') redirectIfLoggedIn();
  });
</script> -->


</body>
</html>